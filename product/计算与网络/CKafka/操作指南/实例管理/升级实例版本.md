消息队列 CKafka 支持进行开源版本升级，帮助用户升级实例至更新版本，从而体验更丰富的功能。同时支持升级内核小版本，实现新功能使用、性能提升、问题修复等功能。

> ?当前仅长沙，莫斯科，法兰克福和新加坡四个地域的 CKafka 专业版实例支持升级版本。



## 操作场景

- 自动升级触发场景**（内核小版本）**

  - 场景一：当 CKafka 版出现重大 bug 或者安全漏洞时，系统会在您的维护时间内发起数据库内核小版本的升级，并提前通过站内信、短信等方式推送升级通知。
  - 场景二：当 CKafka 版发生触发集群迁移的操作（如升配集群规格、扩缩容磁盘容量、CKafka 版本升级等）时，系统会将您的集群升级至最新内核小版本。

- 手动升级场景**（内核小版本+开源 Kafka 版本）**

  除自动升级场景外，用户可自主在控制台手动升级内核小版本和开源 Kafka 版本。



## 注意事项

- 版本升级完成时会涉及集群切换（即秒级实例连接断开），建议程序有自动重连功能，并且建议选择实例可维护时间内做切换。
- 支持低版本实例向高版本升级，不支持降级兼容版本。
- 实例的小版本升级，系统会自动检测，不支持自定义目标版本。
- 实例兼容版本升级，不涉及费用变更。



## 操作步骤

1. 登录 [CKafka 控制台](https://console.cloud.tencent.com/ckafka)。
2. 在左侧导航栏单击**实例列表**，单击目标实例的 “ID/名称”，进入基本信息页。
3. 在**基本信息**模块，单击实例版本右侧的**升级版本**，设置好目标升级版本和升级时间。
   ![](https://qcloudimg.tencent-cloud.cn/raw/3e504214b48b9a7d8a4965b3c1e7603c.png)
   - 升级内核小版本：
     - 当前版本：当前的内核版本。
     - 目标版本：默认升级到最新 Broker 版本，系统会自动检测小版本，如果**小版本升级**按钮无法选择，表示该实例已经是最新的小版本。内核小版本之间的差异，可查看 [参考文档](https://cloud.tencent.com/document/product/597/74464)。
     - 执行时间：可以选择**立即执行**或者**自定义时间**（可选未来24小时内的任意时间），建议选择业务低峰期进行。
   - 升级 Kafka 版本：
     - 当前版本：当前 Kafka 版本。
     - 目标版本：选择要升级的目标 Kafka 版本。开源 Kafka 版本之间的差异，可查看 [参考文档](https://kafka.apache.org/downloads)。
     - 执行时间：可以选择**立即执行**或者**自定义时间**（可选未来24小时内的任意时间），建议选择业务低峰期进行。
4. 单击**确定**，提交升级任务。
5. 在页面上方选择**事件中心**页签，可以看到一条升级实例版本的记录。
   ![](https://qcloudimg.tencent-cloud.cn/raw/c68eaca94229e9589fa03a1743d289a4.png)
6. 单击该记录操作列的**查看详情**，可以查看详细的升级任务进展。
![](https://qcloudimg.tencent-cloud.cn/raw/401662af979fd49586b091ac13880aae.png)
7. 回到实例列表页面，可以看到实例的状态变为**变配中**，同时可以看到升级进度。

   


