本文向您介绍如何通过容器服务控制台在集群内部署超级节点。 

## 前提条件

- 请确保已经 [创建集群](https://cloud.tencent.com/document/product/457/32189)。
- 请确保集群 Kubernetes 版本为1.16及以上版本，支持包年包月超级节点的集群版本为1.16、1.18、1.20。

## 操作步骤

1. 登录 [容器服务控制台](https://console.cloud.tencent.com/tke2)，选择左侧导航栏中的**集群**。
2. 在集群列表页中，单击集群 ID，进入该集群详情页。
3. 选择左侧菜单栏中的**节点管理 > 超级节点**，进入“超级节点”页面。如下图所示：
![](https://qcloudimg.tencent-cloud.cn/raw/c3982c4c2d8bf279053e2da678924425.png)
4. 单击**新建**，进入“新建超级节点”页面，参考以下提示进行设置。如下图所示：
![](https://qcloudimg.tencent-cloud.cn/raw/dd97a0d65f9c164d323b12d9982cef0f.png)
	- **所属节点池**：支持**自动新建节点池**和**加入已有节点池**。选择自动新建节点池时将在创建超级节点时新建超级节点池；选择加入已有节点池可将新建的超级节点加入已有的节点池进行统一管理。超级节点所属的节点池支持加入不同计费模式，不同可用区和不同规格的超级节点。
	- **节点池名称**：若自动新建节点池可对节点池进行命名管理。
	- **超级节点配置**：
	<dx-tabs>
	::: 按量计费
	- **可用区**：选择超级节点所在的可用区。
	- **计费模式**：全地域支持按量计费模式。
	- **容器网络**：为集群内容器分配在容器网络地址范围内的 IP 地址。集群内超级节点的 Pod 会直接占用 VPC 子网 IP（剩余 IP 数将限制调度至超级节点上的 Pod 数），请尽量选择 IP 数量充足且与其他产品使用无冲突的子网。超级节点上的 Pod 会直接运行在用户已指定的 VPC 网络上，每个 Pod 在生命周期内都会绑定一个指定 VPC 内的弹性网卡。您可前往 [弹性网卡列表](https://console.cloud.tencent.com/vpc/eni) 查看 Pod 关联的网卡。
	按量计费模式下，支持选择多个子网，每个子网对应创建一个按量计费的超级节点，按量计费的超级节点创建时不计费，当实际创建工作负载后 Pod 调度至按量计费超级节点时开始按照 Pod 规格和实际运行时长计费。
	<dx-alert infotype="notice" title="">
	- 建议为容器网络配置多个可用区，这样您的工作负载在部署时会自动打散分布在多个可用区，可用性更高。
	- 请确保为容器网络分配 IP 充足的子网，避免创建大规模工作负载时因为 IP 资源耗尽无法创建 Pod。
	</dx-alert>



	:::
	::: 包年包月
	- **可用区**：选择超级节点所在的可用区。
	- **计费模式**：北京、上海、广州、南京支持包年包月计费模式。
	- **容器网络**：为集群内容器分配在容器网络地址范围内的 IP 地址。集群内超级节点的 Pod 会直接占用 VPC 子网 IP（剩余 IP 数将限制调度至超级节点上的 Pod 数），请尽量选择 IP 数量充足且与其他产品使用无冲突的子网。超级节点上的 Pod 会直接运行在用户已指定的 VPC 网络上，每个 Pod 在生命周期内都会绑定一个指定 VPC 内的弹性网卡。您可前往 [弹性网卡列表](https://console.cloud.tencent.com/vpc/eni) 查看 Pod 关联的网卡。
	包年包月计费模式支持选择单个子网，如下图所示：
	![](https://qcloudimg.tencent-cloud.cn/raw/289e79ae0f7c73ebe433b8acd16e22f7.png)
	- **CPU 总规格**：可创建规格50-5000，总规格表示该包年包月超级节点上可调度的 Pod 的 CPU 总核数。
	- **CPU 内存比**：可选择1:2和1:4规格的 CPU 内存比，这里指该包年包月超级节点上的 CPU 与内存总规格的比值，非超级节点上调度的 Pod 的 CPU 内存比，包年包月超级节点支持调度 CPU 内存比为1:1到1:4规格的 Pod。
	- **购买时长**：包年包月超级节点的购买时长。
	- **自动续费**：支持开启包月超级节点自动续费能力。
	<dx-alert infotype="notice" title="">
	- 建议为容器网络配置多个可用区，这样您的工作负载在部署时会自动打散分布在多个可用区，可用性更高。
	- 请确保为容器网络分配 IP 充足的子网，避免创建大规模工作负载时因为 IP 资源耗尽无法创建 Pod。
	</dx-alert>

:::
</dx-tabs>
	- **安全组配置：**详情见 [容器服务安全组设置](https://cloud.tencent.com/document/product/457/9084)。
<dx-alert infotype="notice" title="">
- 超级节点配置的安全组会直接关联 Pod，请配置 Pod 工作所需的网络规则。例如，Pod 启用80端口提供服务，请放通入方向80端口的访问。
- 该安全组为调度到超级节点上 Pod 的默认绑定安全组，您可以在调度时指定其他安全组来覆盖默认安全组。
</dx-alert>
5. （可选）单击更多设置，查看或配置更多信息，如下图所示：
![截屏2022-05-18 下午9.05.57](https://qcloudimg.tencent-cloud.cn/raw/839a23056864553f0dd3dcc61e7a2179.png)
	- **封锁初始节点**：勾选**开启封锁**后，将不接受新的 Pod 调度到该节点，需要手动取消封锁的节点，或在自定义数据中执行 [取消封锁命令](https://cloud.tencent.com/document/product/457/18824)，请按需设置。
	- **Labels**：单击**新增Label**，即可进行 Label 自定义设置。该节点池下所创建的超级节点均将自动增加此处设置的 Label，可用于后续根据 Label 筛选、管理超级节点。
	- **Taints**：节点属性，通常与 Tolerations 配合使用。此处可为节点池下的所有超级节点设置 Taints，确保不符合条件的 Pod 不能够调度到这些节点上，且这些节点上已存在的不符合条件的 Pod 也将会被驱逐。
<dx-alert infotype="explain" title="">
Taints 内容一般由 `key`、`value` 及 `effect` 三个元素组成。其中 `effect` 可取值通常包含以下三种：
- **PreferNoSchedule**：非强制性条件，尽量避免将 Pod 调度到设置了其不能容忍的 taint 的节点上。
- **NoSchedule**：当节点上存在 taint 时，没有对应容忍的 Pod 一定不能被调度。
- **NoExecute**：当节点上存在 taint 时，对于没有对应容忍的 Pod，不仅不会被调度到该节点上，该节点上已存在的 Pod 也会被驱逐。<br>

以设置 Taints `key1=value1:PreferNoSchedule` 为例，控制台配置如下图所示：
![img](https://main.qcloudimg.com/raw/e554317ef5c178297d34eef3f9a7bfa7.png)
</dx-alert>
6. 单击**创建超级节点**即可完成超级节点创建，若选择了自动新建节点池，将同步创建纳管超级节点的超级节点池。


