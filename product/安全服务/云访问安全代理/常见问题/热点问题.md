### 加密后的密文字段怎么计算？
数据加密后，密文数据膨胀，在实施数据加密前需要着重考虑。加密数据中需要保存原始的数据、校验信息以及一些额外的信息，加密后密文数据长度的计算公式为： length = ceil((len × 3 + 34)/3) × 4 + 3。
>! Proxy 代理会根据实际加密后的长度做判断，如果加密后长度大于当前长度，则会写入明文保证数据正常。
>
其中：
- len 为明文数据长度。（数据是中文的时，len 乘以3，数据是英文时，len 不变。）
- ceil() 为向上取整。
- length 为计算得到的密文长度。

### 数据库支持加密哪些字段类型？
- MySQL 支持的字段类型详情，请参见 [MySQL](https://cloud.tencent.com/document/product/1303/48144)。
- PostgreSQL 支持的字段类型详情，请参见 [PostgreSQL](https://cloud.tencent.com/document/product/1303/59210)。

### 已添加的元数据，无法通过 Proxy 访问数据源？
- 若元数据对应的数据源有变动，在 [关系型元数据页面](https://console.cloud.tencent.com/casb/metadata/sql)，到您所需要操作的元数据，单击元数据右侧的**管理**。进入元数据详情页面，单击**同步** > **确定**，修改对应数据。
![](https://qcloudimg.tencent-cloud.cn/raw/3ab1a40de948a984f095cbacdf9fa9e3.png)
- 检查数据源账号密码与实际是否一致。

### 元数据中的账号，是否与实际的数据库账号、密码一致？
是一致的，元数据中的账号就是数据库中实际存在的账号；同时当数据库中的账号密码更换时，元数据中的账号密码也需同步更新。

### 表结构内容改变之后，加解密没有同步更新？
当表结构更新之后，需同步更新元数据中的数据表内容，具体操作如下所示：
1. 在 [关系型元数据页面](https://console.cloud.tencent.com/casb/metadata/sql)，到您所需要操作的元数据，单击元数据右侧的**管理**。
![](https://qcloudimg.tencent-cloud.cn/raw/34c60dba818d17c1a7d8e91941e50f58.png)
2. 在详情页面，单击**更新表结构**，选择所需数据库，单击**使用** > **确定**，即可重新获取表结构。
![](https://qcloudimg.tencent-cloud.cn/raw/b49736f8bba0af462a69e87117de5959.png)

### 全量任务中，如何修复无法解密已加密的数据字段？
- **现象：**无法解密已加密的数据字段。
- **原因：**已加密数据的加密策略被删除，加解密使用非同一个密钥、算法。
- **操作步骤：**
 1. 为被删除策略的数据表设置新的策略：当数据修复完成后，系统会根据新的策略进行数据的加密，然后可通过 Proxy 连接获取明文。
 2. 策略设置完成后，再进行创建数据修复类型的全量任务。
>! 数据修复任务目前只支持如下字段：
> - MySQL：char、varchar、tinytext、text、mediumtext、longtext。
> - PostgreSQL：char、varchar、text。

### 全量任务中，如何统计数据库中存在的明文数据数量？
- **现象：**已配置加密策略的数据库中，某字段存在明文数据。
- **原因：**①配置了加密策略，但字段未加密成功； ②通过非代理情况连接数据库，写入了明文数据。
- **操作步骤：**
 1. 为存在明文数据的数据库配置原有的策略。
 2. 任务完成后，查看**任务执行详情** > **执行结果**，其中：
	 - 结果展示的格式为：db.table.column: num（数据库名:表名:字段名: 明文数量）。
	 - 例如：d1.t1.c1: 10（说明数据库 d1，表 t1 的字段 c1 有10条明文记录）。
>! 明文统计任务目前只支持如下字段：
> - MySQL：char、varchar、tinytext、text、mediumtext、longtext。
> - PostgreSQL：char、varchar、text。
