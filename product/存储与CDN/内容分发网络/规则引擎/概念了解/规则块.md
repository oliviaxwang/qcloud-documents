规则块（Block）为规则引擎的最小组成单元，可通过自由拼接规则块实现对应的执行逻辑程序，满足您的自定义场景。

## 规则块总览
- [条件类型](https://cloud.tencent.com/document/product/228/74435#.E6.9D.A1.E4.BB.B6.E7.B1.BB.E5.9E.8B)
分为默认条件、 独立条件、互斥条件
- [条件表达式](https://cloud.tencent.com/document/product/228/74435#.E6.9D.A1.E4.BB.B6.E8.A1.A8.E8.BE.BE.E5.BC.8F)
分为 if 条件表达式、if...else...if条件表达式
- [匹配项](https://cloud.tencent.com/document/product/228/74435#.E5.8C.B9.E9.85.8D.E9.A1.B9)
用于条件表达式中进行条件匹配，以此识别请求的逻辑
- [行为](https://cloud.tencent.com/document/product/228/74435#.E8.A1.8C.E4.B8.BA)
对于满足匹配项的请求，执行对应的行为
![](https://qcloudimg.tencent-cloud.cn/raw/377907325235c4610d0aaf2687c00d61.png)

 

## 条件类型
### 默认条件
使用这种类型的匹配条件来执行可应用于所有请求的默认行为，一个规则中仅能添加一条默认条件,一个默认条件由列下规则块组成。

| 规则块        | 效果图                                                       | 描述                                                         |
| ------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 默认条件      | ![](https://qcloudimg.tencent-cloud.cn/raw/0a8406ff4909a8127c93378166e2a64e.png) | 指仅包含 **if 条件表达式**，**总是**匹配项，若干**行为**组成的规则块执行逻辑。 |
| if 条件表达式 | ![](https://qcloudimg.tencent-cloud.cn/raw/6107dd9ed72a94b2be8d021b0f16c2f3.png) | **默认条件**默认嵌套**if 条件表达式**。连接总是**匹配项**，以及自定义默认生效的 行为。 |
| 匹配项        | ![](https://qcloudimg.tencent-cloud.cn/raw/f7d23816227ce98a9308c9079ccda544.png) | 默认条件中**if 条件表达式**中默认连接**总是**匹配项，表示所有请求均被匹配。 |

>? 规则引擎至顶向下执行逻辑程序，由于默认条件下所有请求均会被匹配并执行相应行为，不建议将默认条件放在行为冲突的其他条件下方，将使具有相同行为的其他条件失去意义。


### 独立条件
逻辑为简单的 if...then 语句，即匹配条件执行行为，一个独立条件下可以嵌套多层 IF 条件表达式。

| 规则块        | 效果图                                                       | 描述                                                         |
| ------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 独立条件      | ![](https://qcloudimg.tencent-cloud.cn/raw/4cc06948544bc63f74e0e2015ca05935.png) | 指仅包含 **if 条件表达式**的一组规则块执行逻辑。             |
| if 条件表达式 | ![](https://qcloudimg.tencent-cloud.cn/raw/3576b0144f78f18ca8951cba9b7f55f9.png) | if 条件表达式可嵌套到**独立条件**， 以及 **if 条件表达式**中。内部可连接**匹配项**，**行为**，**if 条件表达式**。 |

### 独立条件特点
满足匹配项，则遍历触发所有的行为。

| 满足匹配项 | 执行结果 |
| ---------- | -------- |
| A          | x        |
| B          | y        |
| C          | z        |
| A+B        | x+y      |
| A+B+C      | x+y+z    |


### 互斥条件
逻辑为 if...else if，即满足第一个if中的匹配项，则执行if规则块下的行为，不满足进入else if判断分支，满足后执行行为。

| 规则块                 | 效果图                                                       | 描述                                                         |
| ---------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 互斥条件               | ![](https://qcloudimg.tencent-cloud.cn/raw/5d15097be55cb5b1be4db9449db176b1.png) | 指第一层级仅包含 **if...elseif 条件表达式**的一组规则块执行逻辑。 |
| if...elseif 条件表达式 | ![](https://qcloudimg.tencent-cloud.cn/raw/6c2efd91358a171d5bf76a5ad234fa21.png) | if...esleif 条件表达式可点击＋可新增 **esleif** 分支，仅可嵌套到 **互斥条件** 中。内部可连接一个**匹配项** ，**行为**，**if 条件表达式**。 |

### 互斥条件特点
只有与首个IF匹配相关的功能才会应用于请求 ，满足条件A执行行为，或同时满足条件【非A】、【B】执行行为。

| 满足匹配项 | 执行结果 |
| ---------- | -------- |
| A          | x        |
| !A+B       | y        |


![](https://qcloudimg.tencent-cloud.cn/raw/db911658a804d7b5804c46f3484230a2.png)

 

### 条件表达式
条件分为 if 条件表达式、if...else...if条件表达式，描述如下图所示。

| 规则块                 | 效果图                                                       | 描述                                                         |
| ---------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| if 条件表达式          | ![](https://qcloudimg.tencent-cloud.cn/raw/38cd36812d6322e8bb5f2041bae5adb9.png) | if 条件表达式可嵌套到**独立条件**，**默认条件**，以及 **if 条件表达式**，**if...elseif 条件表达式**中。内部可连接**匹配项**，**行为**，**if 条件表达式**。 |
| if...elseif 条件表达式 | ![](https://qcloudimg.tencent-cloud.cn/raw/493f6109c4984f507cbefff1910cea08.png) | if...esleif 条件表达式中不存在 **else** 分支，点击＋可新增 esleif 分支，仅可嵌套到**互斥条件**中。内部可连接**匹配项**，**行为**，**if 条件表达式**。 |


### 匹配项
用于条件表达式中进行条件匹配，以此识别请求的逻辑和标准，命中匹配项后可执行**行为**或嵌套的**条件表达式**，当前可用的匹配项请请见 [匹配项与行为-匹配项](https://cloud.tencent.com/document/product/228/74435#.E5.8C.B9.E9.85.8D.E9.A1.B9)。

| 规则块 | 效果图                                                       | 描述                                                         |
| ------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 匹配项 | ![](https://qcloudimg.tencent-cloud.cn/raw/c65e2fdfdaf836d9a15a3f8736894042.png) | 1. 匹配项主要用于条件表达式中进行条件匹配。其主要结构如图所示，有元素**匹配项名称**，**操作**，**输入值** |


### 匹配项操作分类
| 操作   | 含义                     | 输入值   |
| ------ | ------------------------ | -------- |
| 等于   | 匹配输入值（单个）       | 字符串   |
| 不等于 | 不匹配输入值（单个）     | 字符串   |
| 包含   | 匹配任一输入值（多个）   | 字符数组 |
| 不包含 | 不匹配任一输入值（多个） | 字符数组 |
|匹配	|正则匹配|	正则表达式
|不匹配	|正则不匹配	|正则表达式|


### 行为
对于条件表达式中满足匹配项的请求，执行对应的行为，当前可用的匹配项请请见 [匹配项与行为-行为](https://cloud.tencent.com/document/product/228/74435#.E8.A1.8C.E4.B8.BA)。

| 操作 | 含义                                                         | 输入值                            |
| ---- | ------------------------------------------------------------ | --------------------------------- |
| 行为 | ![](https://qcloudimg.tencent-cloud.cn/raw/24077fbd676baa204c592cd9b327e4b1.png) | 指定 CDN 的请求，执行具体指令行为 |
